{"ast":null,"code":"import _objectSpread from \"/Users/spbiphones/Dropbox/projects/web projects/podcastsMiniApp/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"/Users/spbiphones/Dropbox/projects/web projects/podcastsMiniApp/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/spbiphones/Dropbox/projects/web projects/podcastsMiniApp/src/pages/custom_views/WaveFormExample.js\";\nimport React, { useCallback, useEffect, useRef, useState, useMemo, useImperativeHandle, forwardRef } from \"react\";\nimport ReactDOM from \"react-dom\";\nimport styled from \"styled-components\";\nimport { WaveSurfer, WaveForm, Region } from \"wavesurfer-react\";\nimport RegionsPlugin from \"wavesurfer.js/dist/plugin/wavesurfer.regions.min\";\nimport TimelinePlugin from \"wavesurfer.js/dist/plugin/wavesurfer.timeline.min\";\nvar isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);\nvar wavesurfer, context, processor;\nvar isUndoClicked = false;\n\nfunction generateNum(min, max) {\n  return Math.random() * (max - min + 1) + min;\n}\n\nconst Button = styled.button``;\n/**\n * @param distance\n * @param min\n * @param max\n * @returns {([*, *]|[*, *])|*[]}\n */\n\nfunction generateTwoNumsWithDistance(distance, min, max) {\n  const num1 = generateNum(min, max);\n  const num2 = generateNum(min, max); // if num2 - num1 < 10\n\n  if (num2 - num1 >= 10) {\n    return [num1, num2];\n  }\n\n  return generateTwoNumsWithDistance(distance, min, max);\n}\n\nvar isGrow = false;\nvar isDown = false;\n\nconst WaveformExample = (props, ref) => {\n  const plugins = useMemo(() => {\n    return [{\n      plugin: RegionsPlugin,\n      options: {\n        color: \"rgba(242, 243, 245, 0.5)\",\n        dragSelection: true\n      }\n    }, {\n      plugin: TimelinePlugin,\n      options: {\n        container: \"#timeline\"\n      }\n    }].filter(Boolean);\n  }, [true]);\n\n  const _useState = useState([]),\n        _useState2 = _slicedToArray(_useState, 2),\n        regions = _useState2[0],\n        setRegions = _useState2[1]; // use regions ref to pass it inside useCallback\n  // so it will use always the most fresh version of regions list\n\n\n  const regionsRef = useRef(regions);\n  useEffect(() => {\n    regionsRef.current = regions;\n  }, [regions]);\n  const regionCreatedHandler = useCallback(region => {\n    console.log(\"region-created --> region:\", region);\n    props.onRegionSelected(region);\n    if (region.data.systemRegionId) return;\n    setRegions([...regionsRef.current, _objectSpread({}, region, {\n      data: _objectSpread({}, region.data, {\n        systemRegionId: -1\n      })\n    })]);\n  }, [regionsRef]);\n  const wavesurferRef = useRef();\n  const handlePosChange = useCallback(position => {\n    console.log(\"position = \" + position);\n  });\n  console.log(\"props.audioSrc = \" + props.audioSrc);\n  const handleWSMount = useCallback(waveSurfer => {\n    wavesurferRef.current = waveSurfer;\n\n    if (wavesurferRef.current) {\n      wavesurferRef.current.load(props.audioSrc);\n      wavesurferRef.current.setVolume(1);\n      wavesurferRef.current.on(\"region-created\", regionCreatedHandler);\n      wavesurferRef.current.on(\"ready\", () => {\n        console.log(\"WaveSurfer is ready\");\n      });\n      wavesurferRef.current.on(\"region-removed\", region => {\n        console.log(\"region-removed --> \", region);\n      });\n      wavesurferRef.current.on(\"loading\", data => {\n        console.log(\"loading --> \", data);\n      });\n      wavesurferRef.current.on(\"audioprocess\", audioprocess);\n      wavesurferRef.current.on(\"interaction\", data => {\n        props.onTimeCodeChanged(wavesurferRef.current.getCurrentTime());\n      });\n\n      if (window) {\n        window.surferidze = wavesurferRef.current;\n      }\n    }\n  }, [regionCreatedHandler]);\n  isGrow = props.isGrow;\n  isDown = props.isDown;\n  const audioprocess = useCallback(data => {\n    props.onTimeCodeChanged(data);\n\n    if (isGrow) {\n      if (data <= 5) {\n        wavesurferRef.current.setVolume(data / 5);\n      }\n    }\n\n    if (isDown) {\n      if (data >= wavesurferRef.current.getDuration() - 5) {\n        wavesurferRef.current.setVolume((wavesurferRef.current.getDuration() - data) / 5);\n      }\n    }\n  }, []);\n  const play = useCallback(() => {\n    wavesurferRef.current.playPause();\n  }, []);\n\n  if (wavesurferRef.current != undefined) {\n    if (props.isPlaying) {\n      wavesurferRef.current.play();\n    } else {\n      wavesurferRef.current.pause();\n    }\n  }\n\n  const timeout = useCallback(() => {\n    isUndoClicked = false;\n    props.disableUndo();\n  }, []);\n  const removeAllRegions = useCallback(() => {\n    setRegions([]);\n  }, [regions]);\n\n  if (wavesurferRef.current != undefined) {\n    console.log(\"click undo = \" + props.isUndo);\n\n    if (props.isUndo && !isUndoClicked) {\n      isUndoClicked = true;\n      removeAllRegions();\n      props.disableUndo();\n      setTimeout(() => {\n        isUndoClicked = false;\n      }, 200);\n    }\n  }\n\n  const handleRegionUpdate = useCallback((region, smth) => {\n    console.log(\"region-update-end --> region:\", region);\n    console.log(smth);\n    props.onCutChanged(region.start, region.end);\n  }, []);\n\n  if (isSafari) {\n    // Safari 11 or newer automatically suspends new AudioContext's that aren't\n    // created in response to a user-gesture, like a click or tap, so create one\n    // here (inc. the script processor)\n    var AudioContext = window.AudioContext || window.webkitAudioContext;\n    context = new AudioContext();\n    processor = context.createScriptProcessor(1024, 1, 1);\n  }\n\n  return React.createElement(\"div\", {\n    className: \"App\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185\n    },\n    __self: this\n  }, React.createElement(WaveSurfer, {\n    onPosChange: handlePosChange,\n    plugins: plugins,\n    onMount: handleWSMount,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"timeline_bg\",\n    id: \"timeline\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188\n    },\n    __self: this\n  }), React.createElement(WaveForm, {\n    barWidth: 2,\n    barRadius: 1,\n    barGap: 3,\n    cursorWidth: 2,\n    height: 96,\n    progressColor: \"#3F8AE0\",\n    audioContext: context || null,\n    audioScriptProcessor: processor || null,\n    responsive: true,\n    loopSelection: true,\n    waveColor: \"#3F8AE0\",\n    cursorColor: \"#FF3347\",\n    id: \"waveform\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189\n    },\n    __self: this\n  }, regions.map(regionProps => React.createElement(Region, Object.assign({\n    onUpdateEnd: handleRegionUpdate,\n    key: regionProps.id\n  }, regionProps, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198\n    },\n    __self: this\n  }))))));\n};\n\nexport default WaveformExample;","map":{"version":3,"sources":["/Users/spbiphones/Dropbox/projects/web projects/podcastsMiniApp/src/pages/custom_views/WaveFormExample.js"],"names":["React","useCallback","useEffect","useRef","useState","useMemo","useImperativeHandle","forwardRef","ReactDOM","styled","WaveSurfer","WaveForm","Region","RegionsPlugin","TimelinePlugin","isSafari","test","navigator","userAgent","wavesurfer","context","processor","isUndoClicked","generateNum","min","max","Math","random","Button","button","generateTwoNumsWithDistance","distance","num1","num2","isGrow","isDown","WaveformExample","props","ref","plugins","plugin","options","color","dragSelection","container","filter","Boolean","regions","setRegions","regionsRef","current","regionCreatedHandler","region","console","log","onRegionSelected","data","systemRegionId","wavesurferRef","handlePosChange","position","audioSrc","handleWSMount","waveSurfer","load","setVolume","on","audioprocess","onTimeCodeChanged","getCurrentTime","window","surferidze","getDuration","play","playPause","undefined","isPlaying","pause","timeout","disableUndo","removeAllRegions","isUndo","setTimeout","handleRegionUpdate","smth","onCutChanged","start","end","AudioContext","webkitAudioContext","createScriptProcessor","map","regionProps","id"],"mappings":"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","sourcesContent":["import React, {\n    useCallback,\n    useEffect,\n    useRef,\n    useState,\n    useMemo,\n    useImperativeHandle,\n    forwardRef\n  } from \"react\";\n  import ReactDOM from \"react-dom\";\n  import styled from \"styled-components\";\n  import { WaveSurfer, WaveForm, Region } from \"wavesurfer-react\";\n  import RegionsPlugin from \"wavesurfer.js/dist/plugin/wavesurfer.regions.min\";\n  import TimelinePlugin from \"wavesurfer.js/dist/plugin/wavesurfer.timeline.min\";\n  var isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);\n  var wavesurfer, context, processor;\n  var isUndoClicked = false\n  function generateNum(min, max) {\n    return Math.random() * (max - min + 1) + min;\n  }\n  const Button = styled.button``;\n  \n  /**\n   * @param distance\n   * @param min\n   * @param max\n   * @returns {([*, *]|[*, *])|*[]}\n   */\n  function generateTwoNumsWithDistance(distance, min, max) {\n    const num1 = generateNum(min, max);\n    const num2 = generateNum(min, max);\n    // if num2 - num1 < 10\n    if (num2 - num1 >= 10) {\n      return [num1, num2];\n    }\n    return generateTwoNumsWithDistance(distance, min, max);\n  }\n  var isGrow = false\n  var isDown = false\n\n const WaveformExample = (props, ref) => {\n    \n    const plugins = useMemo(() => {\n      return [\n        {\n          plugin: RegionsPlugin,\n          options: {\n            color : \"rgba(242, 243, 245, 0.5)\",\n            dragSelection: true\n          }\n        },\n        {\n          plugin: TimelinePlugin,\n          options: {\n            container: \"#timeline\",\n          }\n        }\n      ].filter(Boolean);\n    }, [true]);\n    \n  \n    const [regions, setRegions] = useState([\n     \n    ]);\n  \n    // use regions ref to pass it inside useCallback\n    // so it will use always the most fresh version of regions list\n    const regionsRef = useRef(regions);\n  \n    useEffect(() => {\n      regionsRef.current = regions;\n    }, [regions]);\n  \n    const regionCreatedHandler = useCallback(\n      region => {\n        console.log(\"region-created --> region:\", region);\n        props.onRegionSelected(region)\n        if (region.data.systemRegionId) return;\n  \n        setRegions([\n          ...regionsRef.current,\n          { ...region, data: { ...region.data, systemRegionId: -1 } }\n        ]);\n      },\n      [regionsRef]\n    );\n  \n    const wavesurferRef = useRef();\n    const handlePosChange = useCallback(position => {\n        console.log(\"position = \" + position)\n    })\n    console.log(\"props.audioSrc = \" + props.audioSrc)\n    const handleWSMount = useCallback(\n      waveSurfer => {\n        wavesurferRef.current = waveSurfer;\n        if (wavesurferRef.current) {\n          wavesurferRef.current.load(props.audioSrc);\n          wavesurferRef.current.setVolume(1)\n          wavesurferRef.current.on(\"region-created\", regionCreatedHandler);\n\n          wavesurferRef.current.on(\"ready\", () => {\n            console.log(\"WaveSurfer is ready\");\n          });\n  \n          wavesurferRef.current.on(\"region-removed\", region => {\n            console.log(\"region-removed --> \", region);\n          });\n  \n          wavesurferRef.current.on(\"loading\", data => {\n            console.log(\"loading --> \", data);\n          });\n          wavesurferRef.current.on(\"audioprocess\", audioprocess);\n          wavesurferRef.current.on(\"interaction\", data => {\n            props.onTimeCodeChanged(wavesurferRef.current.getCurrentTime())\n          });\n  \n          if (window) {\n            window.surferidze = wavesurferRef.current;\n          }\n        }\n        \n      },\n      [regionCreatedHandler]\n    );\n    isGrow = props.isGrow\n    isDown = props.isDown\n    const audioprocess = useCallback((data) => {\n            props.onTimeCodeChanged(data)\n            if (isGrow){\n                if (data <= 5){\n                    wavesurferRef.current.setVolume(data/5)\n                }\n            } \n            if (isDown){\n                if (data >= (wavesurferRef.current.getDuration() - 5)){\n                    wavesurferRef.current.setVolume((wavesurferRef.current.getDuration() - data)/5)\n                }\n            }\n      }, []);\n    const play = useCallback(() => {\n      wavesurferRef.current.playPause();\n    }, []);\n    if (wavesurferRef.current != undefined){\n        if (props.isPlaying){\n            wavesurferRef.current.play()\n        } else {\n            wavesurferRef.current.pause()\n        }\n    }\n    const timeout = useCallback(() => {\n        isUndoClicked = false\n        props.disableUndo()\n    }, []);\n    const removeAllRegions = useCallback(() => {\n        setRegions([]);\n      }, [regions]);\n    if (wavesurferRef.current != undefined){\n        console.log(\"click undo = \" + props.isUndo)\n        if (props.isUndo && !isUndoClicked){\n            isUndoClicked = true\n            removeAllRegions()\n            props.disableUndo()\n            setTimeout(() => {\n                isUndoClicked = false\n            }, 200)\n        }\n    }\n    \n    const handleRegionUpdate = useCallback((region, smth) => {\n        console.log(\"region-update-end --> region:\", region);\n        console.log(smth);\n        props.onCutChanged(region.start, region.end)\n      }, []);\n      if (isSafari) {\n        // Safari 11 or newer automatically suspends new AudioContext's that aren't\n        // created in response to a user-gesture, like a click or tap, so create one\n        // here (inc. the script processor)\n        var AudioContext =\n            window.AudioContext || window.webkitAudioContext;\n        context = new AudioContext();\n        processor = context.createScriptProcessor(1024, 1, 1);\n    }\n    return (\n      \n      <div className=\"App\">\n           \n        <WaveSurfer onPosChange={handlePosChange} plugins={plugins} onMount={handleWSMount}>\n          <div className=\"timeline_bg\" id=\"timeline\" />\n          <WaveForm \n                    barWidth={2}\n                    barRadius={1}\n                    barGap={3}\n                    cursorWidth={2}\n                    height={96} progressColor={\"#3F8AE0\"}\n                    audioContext={context || null}\n                    audioScriptProcessor={processor || null} responsive={true} loopSelection={true} waveColor={\"#3F8AE0\"} cursorColor={\"#FF3347\"}  id=\"waveform\">\n            {regions.map(regionProps => (\n            <Region\n              onUpdateEnd={handleRegionUpdate}\n              key={regionProps.id}\n              {...regionProps}\n            />\n          ))}\n          </WaveForm>\n        </WaveSurfer>\n        \n      </div>\n    );\n }\n  export default WaveformExample;"]},"metadata":{},"sourceType":"module"}